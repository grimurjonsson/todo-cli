---
phase: 01-clipboard-support
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [Cargo.toml, src/clipboard.rs, src/lib.rs]
autonomous: true

must_haves:
  truths:
    - "arboard crate is available as a dependency"
    - "Clipboard module provides copy_to_clipboard function"
  artifacts:
    - path: "Cargo.toml"
      provides: "arboard dependency with wayland-data-control feature"
      contains: "arboard"
    - path: "src/clipboard.rs"
      provides: "Cross-platform clipboard copy function"
      exports: ["copy_to_clipboard"]
      min_lines: 15
  key_links:
    - from: "src/clipboard.rs"
      to: "arboard::Clipboard"
      via: "use arboard::Clipboard"
      pattern: "use arboard::Clipboard"
---

<objective>
Add arboard clipboard dependency and create clipboard module for cross-platform copy support.

Purpose: Establish the foundation for clipboard operations that work on macOS, Windows, and Linux (X11/Wayland).
Output: Cargo.toml with arboard dependency, src/clipboard.rs module with copy function.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
@.planning/research/PITFALLS.md

@Cargo.toml
@src/lib.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add arboard dependency to Cargo.toml</name>
  <files>Cargo.toml</files>
  <action>
    Add arboard dependency with wayland-data-control feature to the [dependencies] section.

    Add this line after the existing dependencies (maintain alphabetical order with other crates):
    ```
    arboard = { version = "3.6", features = ["wayland-data-control"] }
    ```

    The wayland-data-control feature is REQUIRED for Linux Wayland support. Without it, clipboard operations fail silently on pure Wayland systems (increasingly common in 2025+).
  </action>
  <verify>cargo check compiles without errors</verify>
  <done>arboard crate is a project dependency with wayland feature enabled</done>
</task>

<task type="auto">
  <name>Task 2: Create clipboard module with copy function</name>
  <files>src/clipboard.rs, src/lib.rs</files>
  <action>
    Create src/clipboard.rs with a `copy_to_clipboard` function:

    ```rust
    use anyhow::{Context, Result};
    use arboard::Clipboard;

    /// Copy text to the system clipboard.
    ///
    /// Returns Ok(()) on success, or an error if clipboard is unavailable.
    /// On Linux, clipboard contents persist while the application is running.
    pub fn copy_to_clipboard(text: &str) -> Result<()> {
        let mut clipboard = Clipboard::new()
            .context("Failed to access system clipboard")?;
        clipboard
            .set_text(text)
            .context("Failed to copy text to clipboard")?;
        Ok(())
    }
    ```

    Then export the module from src/lib.rs by adding:
    ```rust
    pub mod clipboard;
    ```

    Keep the module simple - no thread safety complexity needed since TUI is single-threaded.

    DO NOT:
    - Add image clipboard support (not needed)
    - Add clipboard read/paste support (out of scope per REQUIREMENTS.md)
    - Store Clipboard instance persistently (simple per-operation creation is fine for TUI)
  </action>
  <verify>cargo check passes, `use to_tui::clipboard::copy_to_clipboard` resolves</verify>
  <done>clipboard module exists and exports copy_to_clipboard function</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo check` passes without errors
- [ ] `cargo clippy` passes without warnings
- [ ] arboard appears in Cargo.toml with wayland-data-control feature
- [ ] src/clipboard.rs exists with copy_to_clipboard function
- [ ] src/lib.rs exports clipboard module
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No clippy warnings introduced
- Module follows existing crate conventions (anyhow::Result, with_context pattern)
</success_criteria>

<output>
After completion, create `.planning/phases/01-clipboard-support/01-01-SUMMARY.md`
</output>
